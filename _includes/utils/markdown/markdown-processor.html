{% comment %}
  Process markdown html for site page output.
{% endcomment %}

{%- if include.markdown and include.markdown != "" -%}
    {% comment %}
      Add link before each heading (h1-h6) as a url fragment based on heading
      id in the heading tag generated by markdown parser.
      https://github.com/github/cmark-gfm/issues/186
      https://github.com/allejo/jekyll-anchor-headings
      https://gist.github.com/ritchiecarroll/132715b38c071cbd01b1d3a0da60822a
    {% endcomment %}
    {%- capture markdown -%}{%- include utils/markdown/anchor_headings.html html=include.markdown beforeHeading=true anchorClass="anchor" anchorBody="<svg class='octicon octicon-link' viewBox='0 0 16 16' version='1.1' width='16' height='32' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>" -%}{%- endcapture -%}

    {%- assign markdown = markdown | replace: "@SITE__TITLE@", site.title -%}
    {%- assign markdown = markdown | replace: "@SITE__URL@", site.site_source -%}

    {%- assign lang = page.lang | default: site.lang -%}
    {%- assign markdown = markdown | replace: "@PAGE__LANG@", lang -%}
    {{- markdown -}}
{%- endif -%}
